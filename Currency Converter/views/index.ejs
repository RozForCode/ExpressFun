<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Converter</title>
    <link rel="stylesheet" href="public/NJ_app.css">
    <script type="text/javascript" src="modules\NJ_validations.js"></script>


</head>

<body>
    <h1>Author - 991745899, Navrose Singh Johal</h1>
    <h2>Professor - Sukhbir Tatla</h2>
    <h1>Welcome to the Currency Conversion Portal</h1>
    <form method="Post" onsubmit="return formSubmit()" action="\">
        <label for="amount">Enter Number:</label>
        <input type="number" id="amount" name="amount" autofocus><br>

        <label for="currency1">Select currency you have:</label>
        <select id="currency1" name="currency1">
            <option value="cad">CAD</option>
            <option value="franc">Franc</option>
            <option value="usd">USD</option>
            <option value="euros">Euros</option>
            <option value="pound">Pound</option>
        </select><br>

        <label for="currency2">Select currency you want:</label>
        <select id="currency2" name="currency2">
            <option value="cad">CAD</option>
            <option value="franc">Franc</option>
            <option value="usd">USD</option>
            <option value="euros">Euros</option>
            <option value="pound">Pound</option>
        </select><br>

        <button type="submit" id="calculateButton" onclick="">Calculate</button>
        <button type="button" id="clearButton">Clear</button>
        <script>
            document.getElementById('clearButton').onclick = () => {
                document.getElementById('amount').value = "";
                document.getElementById('currency1').value = -1;
                document.getElementById('currency2').value = -1;
                document.getElementById('result').innerHTML = "";
                document.getElementById('amount').focus();
            }
            function formSubmit(event) {
                event.preventDefault(); // Prevent the form from submitting normally

                let currency1 = document.getElementById('currency1').value;
                let currency2 = document.getElementById('currency2').value;
                let amount = document.getElementById('amount').value;
                let result = document.getElementById('result');

                // Validate the input
                if (isNaN(amount) || amount <= 0) {
                    result.innerHTML = "Amount should be a positive number";
                    return;
                }
                if (currency1 === currency2) {
                    result.innerHTML = "Currencies cannot be the same";
                    return;
                }

                // Send data to the server
                fetch('/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: { amount, currency1, currency2 }
                })
                    .then(response => response.json())
                    .then(data => {
                        result.innerHTML = data.result;
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            }
        </script>
    </form>
    <p id="result">
        <%= result%>
    </p>
    <script type=" module" src="app.js">
            </script>
</body>

</html>